<html>
	<head>
		<meta charset="utf-8">
		<style>
			body {
				background-color: #ffffff;
				margin: 0;
				overflow: hidden;
			}
		</style>
	</head>
	<body>
		<script src="~/three.js/build/three.min.js"></script>

		<script src="~/three.js/examples/js/controls/TrackballControls.js"></script>

		<script src="~/three.js/examples/js/renderers/CSS3DRenderer.js"></script>

		<script type="text/python">
pythonjs.configure(javascript=True)
camera = scene = renderer = None
geometry = material = mesh = None
scene2 = renderer2 = renderer3 = None
controls = None

init();
animate();

def init():
	global camera, scene, scene2, scene3, renderer, renderer2, renderer3
	global geometry, material, mesh
	global controls

	camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 1000 );
	camera.position.set( 200, 200, 200 );

	controls = new THREE.TrackballControls( camera );

	controls.rotateSpeed = 1.0;
	controls.zoomSpeed = 1.2;
	controls.panSpeed = 0.8;

	controls.noZoom = false;
	controls.noPan = false;

	controls.staticMoving = false;
	controls.dynamicDampingFactor = 0.3;

	controls.keys = [ 65, 83, 68 ];

	scene = new THREE.Scene();
	scene3 = new THREE.Scene();

	light = new( THREE.PointLight() )
	light.position.set( 0, 360, 290 )
	scene.add( light )

	geometry = new THREE.BoxGeometry( 200, 200, 200 );
	material = new THREE.MeshPhongMaterial( color=0xff00ff, transparent=true, opacity=0.97 );

	mesh = new THREE.Mesh( geometry, material );
	scene.add( mesh );

	renderer = new THREE.WebGLRenderer(alpha=True);
	#renderer = new THREE.CanvasRenderer(alpha=True);
	renderer.setSize( window.innerWidth, window.innerHeight );
	#document.body.appendChild( renderer.domElement );
	renderer.domElement.style.position = 'absolute';
	renderer.domElement.style.top = 0;
	renderer.domElement.style.zIndex = 1;

	//

	scene2 = new THREE.Scene();

	def onclick(e):
		this.parentNode.appendChild(document.createTextNode('hello'))
		#alert('hi')


	for i in range(20):

		var element = document.createElement( 'div' );
		element.style.width = '100px';
		element.style.height = '100px';
		element.style.background = new THREE.Color( Math.random() * 0xffffff ).getStyle();
		b = document.createElement('button')
		b.appendChild(document.createTextNode('click me'))
		b.onclick = onclick
		element.appendChild(b)

		var object = new THREE.CSS3DObject( element );
		object.position.x = Math.random() * 200 - 100;
		object.position.y = Math.random() * 200 - 100;
		object.position.z = Math.random() * 200 - 100;
		object.scale.x = Math.random() + 0.5;
		object.scale.y = Math.random() + 0.5;
		scene2.add( object );

		geo = new THREE.BoxGeometry( object.scale.x*100.1, object.scale.y*100.1, 10 );
		#mat = new THREE.MeshPhongMaterial( { 'color': 0x00ffff, 'transparent':true, 'opacity':0.5 } );
		mat = new THREE.MeshBasicMaterial( color=0x000000, opacity=0 )
		mat.blending = THREE.NoBlending
		m = new THREE.Mesh( geo, mat );
		scene.add( m );
		m.position.copy( object.position )
		m.position.z -= 4

		var obj = new THREE.CSS3DObject( element.cloneNode() );
		obj.position.copy(object.position)
		obj.position.z += 1
		obj.scale.copy(object.scale)
		scene3.add( obj );


	//

	renderer2 = new THREE.CSS3DRenderer();
	renderer2.setSize( window.innerWidth, window.innerHeight );
	renderer2.domElement.style.position = 'absolute';
	renderer2.domElement.style.top = 0;
	renderer2.domElement.style.zIndex = 0;
	document.body.appendChild( renderer2.domElement );

	renderer3 = new THREE.CSS3DRenderer();
	renderer3.setSize( window.innerWidth, window.innerHeight );
	renderer3.domElement.style.position = 'absolute';
	renderer3.domElement.style.top = 0;
	renderer3.domElement.style.opacity = 0.15;
	renderer3.domElement.style.zIndex=200;

	document.body.appendChild( renderer2.domElement );
	document.body.appendChild( renderer.domElement );
	document.body.appendChild( renderer3.domElement );



def animate():

	requestAnimationFrame( animate );

	controls.update();

	renderer2.render( scene2, camera );
	renderer.render( scene, camera );
	renderer3.render( scene3, camera );


		</script>
	</body>
</html>
